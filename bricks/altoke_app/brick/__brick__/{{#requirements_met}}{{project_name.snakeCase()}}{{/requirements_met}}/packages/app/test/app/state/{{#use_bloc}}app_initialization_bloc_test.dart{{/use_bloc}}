

import 'package:{{#requirements_met}}{{project_name.snakeCase()}}{{/requirements_met}}/app/app.dart';
import 'package:bloc_test/bloc_test.dart';

import 'package:flutter_test/flutter_test.dart';




void main() {
  group('$AppInitializationBloc', () {
    test('initial state is $AppUninitialized', () {
      final bloc = AppInitializationBloc(
        initializationCallback: () async => fail(
          'initializationCallback should not be called',
        ),
        
      );
      addTearDown(bloc.close);
      expect(bloc.state, const AppUninitialized());
    });

    group('$AppInitializationRequested', () {
      blocTest<AppInitializationBloc, AppInitializationState>(
        'emits ['
        '$AppInitializing, '
        '$FailedAppInitialization'
        '] '
        'when the current state is $AppUninitialized '
        'and the initialization fails',
        build: () => AppInitializationBloc(
          initializationCallback: () async =>
              throw Exception('Failed to initialize'),
          
        ),
        seed: AppUninitialized.new,
        act: (bloc) => bloc.add(const AppInitializationRequested()),
        expect: () => [
          const AppInitializing(),
          const FailedAppInitialization(
            
          ),
        ],
      );

      blocTest<AppInitializationBloc, AppInitializationState>(
        'emits ['
        '$AppInitializing, '
        '$SuccessfulAppInitialization'
        '] '
        'when the current state is $AppUninitialized '
        'and the initialization is successful',
        build: () => AppInitializationBloc(
          initializationCallback: () async {
            return expectAsync0(
              () async {},
              id: 'initializationCallback',
            )();
          },
          
        ),
        seed: AppUninitialized.new,
        act: (bloc) {
          bloc.add(const AppInitializationRequested());
          return pumpEventQueue();
        },
        expect: () => [
          const AppInitializing(),
          const SuccessfulAppInitialization(),
        ],
      );
    });
  });
}
